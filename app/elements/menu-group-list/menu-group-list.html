<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="menu-group-list">

    <template>
        <style>
            .title {
                color: #5e5d5e;
                font-weight: 600;
                margin: 4px 4px 4px 40px;
                height: 32px;
                transition: 0.2s;
                overflow: hidden;
            }

            .title:hover {
                color: #4185f6;
                margin: 4px 4px 4px 50px;
                transition: 0.2s;
            }

            .title img {
                border-radius: 2px;
                margin-right: 8px;
                height: 32px;
                width: 32px;
            }
        </style>

        <iron-ajax
                id="request"
                url=""
                handle-as="json"
                last-response="{{response}}"></iron-ajax>

        <div class="layout vertical">
            <template is="dom-repeat" items="{{response.groups}}">
                <iron-ajax
                        auto
                        url="{{groupURL(item)}}"
                        handle-as="json"
                        last-response="{{group}}"></iron-ajax>
                
                <div class="layout horizontal title">
                    <img class="groupCover" src="[[group.img]]">
                    <span class="groupTitle">{{group.name}}</span>
                </div>
            </template>
        </div>

    </template>
</dom-module>

<script>
    Polymer({
        is: 'menu-group-list',
        properties: {
        },
        computeURL: function() {
            var id = app.getUserId();
            return 'http://api.oversimplified.io/users/' + id;
        },
        groupURL: function (id) {
            return 'http://api.oversimplified.io/groups/' + id;
        },
        refresh: function () {
            this.$.request.url = this.computeURL();
            this.$.request.generateRequest();
        }
    });
</script>