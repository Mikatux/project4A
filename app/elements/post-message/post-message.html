<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="post-message">
  <template>
    <style include="shared-styles"></style>
    <style>
      :host {
        display: block;
        box-sizing: border-box;
        max-width: 512px;
      }
      
      #card-message {
        background-color: #FFFFFF;
        margin: 12px;
      }
      
      .avatar {
    		border-radius: 2px;
    		width: 40px;
    		height: 40px;
    		position: relative;
    	}
    	
    	.username {
    	  font-size: 18px;
    		text-transform: capitalize;
    		font-weight: 500;
    		color: var(--accent-color);
    		line-height: 1.3em;
    		max-width: 90%;
    		text-overflow: ellipsis;
    		overflow: hidden;
    		white-space: nowrap;
    	}
      
      .timestamp {
        font-size: 14px;
    		font-weight: 300;
    		color: #b5a896;
    		line-height: 1.3em;
    		max-width: 90%;
    		text-overflow: ellipsis;
    		overflow: hidden;
    		white-space: nowrap;
      }
      
      #head {
        padding: 4px;
        background-color:#FDFDFD;
      }
      
      #name-zone {
        padding-left: 16px;
        width: 60%;
      }
      
      #content {
        min-height: 32px;
        padding: 8px 8px 8px 8px;
      }
      
      paper-icon-button.small {
        width: 18px;
        height: 18px;
        color: #EAEAEA;
        
        -webkit-transition: 0.3s;
        transition: 0.3s;
      }
      
      paper-icon-button.small::shadow #icon {
        width: 18px;
        height: 18px;
      }
      
      paper-icon-button.small:hover {
        color: #DADADA;
        
        -webkit-transition: 0.3s;
        transition: 0.3s;
      }
      
      #separator {
        height: 1px;
        width: 100%;
        background-color: var(--primary-background-color);
      }
    </style>
    
    <iron-ajax
      id="deleteMessage"
      
      url=""
      method="DELETE"
      on-response="handleResponse"
      debounce-duration="300">
    </iron-ajax>
    
    <paper-material elevation="1" flex id="card-message">
      <div id="head" class="horizontal layout flex">
        <div>
          <img src="{{item.author.img}}" alt="avatar" class="avatar">
        </div>
        <div class="vertical layout" id="name-zone">
          <span class="username">{{item.author.name}}</span>
          <span class="timestamp">{{item.date}}</span>
        </div>
        <div class="horizontal end-justified layout" flex>
          <paper-icon-button icon="report" class="small"></paper-icon-button>
          <paper-icon-button icon="favorite" class="small"></paper-icon-button>
          <paper-icon-button icon="delete" class="small" onclick="deletePost"></paper-icon-button>
        </div>
      </div>
      <div id="separator"></div>
      
      <div id="content">
        <span>{{item.content}}</span>
      </div>
    </paper-material>

  </template>

  <script>
    Polymer({
      is: 'post-message',
      properties: {
        item: Object
      },
      
      deletePost: function() {
        console.log("delete");
        var ajax = document.getElementById('deleteMessage');
        ajax.url = "http://back.oversimplified.io/message/" + this.item._id;
        console.log(ajax.url);
        ajax.generateRequest();
      }
    });
  </script>

</dom-module>
